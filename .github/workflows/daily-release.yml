name: Daily build

on:
  schedule:
    - cron: "0 0 * * *" # Runs daily at midnight UTC

permissions:
  contents: read
  packages: write

jobs:

  build-and-upload:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4
   
    - name: Install X11 headers
      run: sudo apt-get install -y libgl1-mesa-dev xorg-dev
   
    - name: Set up Go
      uses: actions/setup-go@v5
      with:
       go-version: 'stable'
       cache: false

    - name: Display the release tag
      run: echo ${{ github.sha }} # Use commit SHA as tag
   
    - name: Test
      run: go test -v .
   
    - name: Build
      run: go build -v ./cmd/essentialist

    - name: List the executable
      run: ls -l ./essentialist
   
    - name: Upload Artifacts
      uses: actions/upload-artifact@v4
      with:
        name: Linux daily build
        path: ./essentialist
